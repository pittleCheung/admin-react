import{r as i,j as t,a3 as b,$ as r,bb as x,b2 as o,g as p,aS as h,I as M,S as v,T as g}from"./index.0ce2eb6d.js";import{D as k,l as w,d as S}from"./zh_CN.320f5cb2.js";import{d as C,p as Y}from"./tools.decfb751.js";import{T as P}from"./Table.8b57651f.js";import"./index.08278916.js";var j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};const z=j;var T=function(u,l){return t(b,{...u,ref:l,icon:z})};const H=i.exports.forwardRef(T);function $(){return r.get("/notice")}function q(n){return r.post("/notice/destory",n)}function L(n){return r.post("/notice/add",n)}function V(n){return r.post("/notice/update",n)}const _=x.confirm,J=()=>{const[n,u]=i.exports.useState(C("announceManage")),[l,s]=i.exports.useState(!1),[c,E]=i.exports.useState(!1),[d]=o.useForm(),D=e=>{E(!0),s(!0),d.setFieldsValue({id:e.id,content:e.content,time:S(e.end_time)})},y=async e=>{_({icon:t(H,{}),content:t("div",{children:"\u786E\u5B9E\u662F\u5426\u5220\u9664?"}),onOk(){var a;n.list=(a=n.list)==null?void 0:a.filter(O=>O.id!==e.id),u({...n,list:n.list}),q({id:e.id})},onCancel(){console.log("Cancel")}})},B=[{title:"ID",dataIndex:"id",render:e=>t("a",{children:e})},{title:"\u5185\u5BB9",dataIndex:"content",render:e=>t("a",{children:e})},{title:"\u7ED3\u675F\u65F6\u95F4",dataIndex:"end_time",render:e=>t("a",{children:e})},{title:"\u72B6\u6001",dataIndex:"enabled",render:e=>t("a",{children:e==0?"\u542F\u7528\u4E2D":"\u5DF2\u5230\u671F\u4E0B\u7EBF"})},{title:"\u64CD\u4F5C",render:(e,a)=>p(v,{children:[t(g,{placement:"top",title:"\u7F16\u8F91",children:t("a",{onClick:()=>D(a),style:{cursor:"pointer"},children:"\u7F16\u8F91"})}),t(g,{placement:"top",title:"\u5220\u9664",children:t("a",{onClick:()=>y(a),style:{cursor:"pointer"},children:"\u5220\u9664"})})]})}],m=(e=Y(n.paging))=>{$().then(a=>{console.log("res",a),u(C("announceManage",a))})},A=()=>{s(!0)},f=async()=>{const e=await d.validateFields();e.time&&(e.time=e.time.format("YYYY-MM-DD HH:mm:ss")),c?await V(e):await L(e),m(),s(!1)},F=()=>{s(!1)};i.exports.useEffect(()=>{m()},[]);const I={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}};return p("div",{children:[t(h,{type:"primary",onClick:A,children:"\u6DFB\u52A0\u516C\u544A"}),t(P,{columns:B,pagination:{...n.paging,onChange:(e,a)=>m({page:e,size:a})},dataSource:n.list,rowKey:e=>e.id}),t(x,{title:c?"\u4FEE\u6539\u516C\u544A":"\u6DFB\u52A0\u516C\u544A",destroyOnClose:!0,open:l,onOk:f,onCancel:F,footer:[t(h,{onClick:F,children:"\u53D6\u6D88"},"back"),t(h,{type:"primary",onClick:f,children:c?"\u786E\u8BA4\u4FEE\u6539":"\u786E\u8BA4\u6DFB\u52A0"},"submit")],children:p(o,{...I,style:{maxWidth:600},form:d,preserve:!1,children:[t(o.Item,{name:"id"}),t(o.Item,{label:"\u5185\u5BB9",name:"content",rules:[{required:!0,message:"Please input your content!"}],children:t(M,{placeholder:"\u8BF7\u8F93\u5165\u516C\u544A\u5185\u5BB9"})}),t(o.Item,{name:"time",label:"\u5230\u671F\u65F6\u95F4",rules:[{type:"object",required:!0,message:"Please select time!"}],children:t(k,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss",locale:w})})]})})]})};export{J as default};
